<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–í—ã–±–æ—Ä —Ç–µ—Å—Ç–∞</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container" style="position: relative;">
    <div class="header">
      <img src="assets/logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø –ó–ö–ê–¢–£" class="logo">
      <h1>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ—Å—Ç</h1>
    </div>

    <div id="testList"></div>
    <button onclick="location.href='index.html'" style="position: absolute; top: 20px; left: 20px; background-color: #FFD200; color: #003366; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer;">
      &larr;
    </button>
  </div>

  <script>
    const list = document.getElementById('testList');
    const allTests = JSON.parse(localStorage.getItem('allTests')) || [];

    if (allTests.length === 0) {
      list.innerHTML = '<p>–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤.</p>';
    } else {
      allTests.forEach(test => {
        const div = document.createElement('div');
        div.style.marginBottom = '20px';
        div.innerHTML = `
          <h3>${test.title}</h3>
          <button onclick="startTest('${test.id}')">üß™ –ü—Ä–æ–π—Ç–∏</button>
          <button onclick="copyLink('${test.id}')">üîó –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
          <button onclick="deleteTest('${test.id}')">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
        `;
        list.appendChild(div);
      });
    }

    function startTest(id) {
      localStorage.setItem('currentTestId', id);
      location.href = 'test.html';
    }

    function copyLink(id) {
      const link = `${window.location.origin}/test.html?id=${id}`;
      navigator.clipboard.writeText(link).then(() => {
        alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞: ' + link);
      }).catch(err => {
        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—Å—ã–ª–∫–∏: ' + err);
      });
    }

    function deleteTest(id) {
      if (!confirm("–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–µ—Å—Ç?")) return;
      const updated = allTests.filter(t => t.id !== id);
      localStorage.setItem('allTests', JSON.stringify(updated));

      // –µ—Å–ª–∏ —É–¥–∞–ª—ë–Ω–Ω—ã–π –±—ã–ª –∞–∫—Ç–∏–≤–Ω—ã–º ‚Äî —Å–±—Ä–æ—Å–∏—Ç—å
      if (localStorage.getItem('currentTestId') === id) {
        localStorage.removeItem('currentTestId');
      }
      if (localStorage.getItem('editTestId') === id) {
        localStorage.removeItem('editTestId');
      }

      location.reload();
    }
  </script>
</body>
</html>
